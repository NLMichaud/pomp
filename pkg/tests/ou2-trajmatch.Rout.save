
R version 2.11.1 (2010-05-31)
Copyright (C) 2010 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(pomp)
> 
> data(ou2)
> true.p <- coef(ou2)
> simdata <- simulate(ou2,nsim=5,params=true.p,seed=394885)
> guess.p <- true.p
> guess.p[grep('sigma',names(guess.p))] <- 0
> 
> x <- sapply(
+             simdata,
+             function (d) {
+               res <- traj.match(
+                                 d,
+                                 start=guess.p,
+                                 est=c('alpha.1','alpha.4','x1.0','x2.0','tau'),
+                                 maxit=2000,
+                                 reltol=1e-8
+                                 )
+               c(conv=res$convergence,loglik=logLik(res),coef(res))
+             }
+             )
> range(x['conv',])
[1] 0 0
> range(x['loglik',])
[1] -688.0077 -567.8361
> print(
+       cbind(
+             truth=true.p,
+             mean.est=apply(x[names(true.p),],1,mean),
+             bias=apply(x[names(true.p),],1,mean)-true.p,
+             se=apply(x[names(true.p),],1,sd)
+             ),
+       digits=4
+       )
        truth mean.est     bias     se
alpha.1   0.8   0.6724 -0.12758 0.3949
alpha.2  -0.5  -0.5000  0.00000 0.0000
alpha.3   0.3   0.3000  0.00000 0.0000
alpha.4   0.9   0.8318 -0.06822 0.4922
sigma.1   3.0   3.0000  0.00000 0.0000
sigma.2  -0.5  -0.5000  0.00000 0.0000
sigma.3   2.0   2.0000  0.00000 0.0000
tau       1.0   6.0282  5.02824 1.4802
x1.0     -3.0  -3.3701 -0.37012 2.7226
x2.0      4.0   2.3504 -1.64964 4.4465
> 
> summary(traj.match(ou2,est=c('alpha.1','alpha.4','x1.0','x2.0','tau'),method="subplex",maxit=100))
$params
   alpha.1    alpha.2    alpha.3    alpha.4    sigma.1    sigma.2    sigma.3 
 0.8913424 -0.5000000  0.3000000  0.2309642  3.0000000 -0.5000000  2.0000000 
       tau       x1.0       x2.0 
 5.3538853 -2.6942832  9.5177620 

$loglik
[1] -619.7905

$eval
[1] 100

$convergence
[1] -1

$msg
[1] "number of function evaluations exceeds `maxit'"

> 
> summary(traj.match(ou2,est=c('alpha.1','alpha.4','x1.0','x2.0','tau'),eval.only=T))
$params
alpha.1 alpha.2 alpha.3 alpha.4 sigma.1 sigma.2 sigma.3     tau    x1.0    x2.0 
    0.8    -0.5     0.3     0.9     3.0    -0.5     2.0     1.0    -3.0     4.0 

$loglik
[1] -3327.081

$eval
[1] 1 0

$convergence
[1] NA

$msg
[1] "no optimization performed"

> 
> 
