
R version 2.11.1 (2010-05-31)
Copyright (C) 2010 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(pomp)
This is pomp version 0.34-1

IMPORTANT NOTICE:
The default behaviors of 'simulate' and 'trajectory' have changed as of release 0.34-1. You can ensure that your code will continue to function as you intend by specifying the values of the 'times' and 't0' arguments to these functions, thus removing dependence of your code on the defaults. In the meantime, using 'simulate' or 'trajectory' in such a way as to rely on the default will produce a warning. These warnings will be removed in a future release.

See the documentation ("pomp?simulate", "pomp?trajectory") for a description of the new default behaviors.

Subscribe to the pomp-announce list (go to pomp.r-forge.r-project.org) to receive email notification about new releases of pomp including descriptions of feature additions, changes, and fixes.


> 
> data(ou2)
> true.p <- coef(ou2)
> simdata <- simulate(ou2,nsim=5,params=true.p,seed=394885)
> guess.p <- true.p
> guess.p[grep('sigma',names(guess.p))] <- 0
> 
> x <- sapply(
+             simdata,
+             function (d) {
+               res <- traj.match(
+                                 d,
+                                 start=guess.p,
+                                 est=c('alpha.1','alpha.4','x1.0','x2.0','tau'),
+                                 maxit=2000,
+                                 reltol=1e-8
+                                 )
+               c(conv=res$convergence,loglik=res$value,res$params)
+             }
+             )
> range(x['conv',])
[1] 0 0
> range(x['loglik',])
[1] -688.0077 -567.8361
> print(
+       cbind(
+             truth=true.p,
+             mean.est=apply(x[names(true.p),],1,mean),
+             bias=apply(x[names(true.p),],1,mean)-true.p,
+             se=apply(x[names(true.p),],1,sd)
+             ),
+       digits=4
+       )
        truth mean.est     bias     se
alpha.1   0.8   0.6724 -0.12758 0.3949
alpha.2  -0.5  -0.5000  0.00000 0.0000
alpha.3   0.3   0.3000  0.00000 0.0000
alpha.4   0.9   0.8318 -0.06822 0.4922
sigma.1   3.0   0.0000 -3.00000 0.0000
sigma.2  -0.5   0.0000  0.50000 0.0000
sigma.3   2.0   0.0000 -2.00000 0.0000
tau       1.0   6.0282  5.02824 1.4802
x1.0     -3.0  -3.3701 -0.37012 2.7226
x2.0      4.0   2.3504 -1.64964 4.4465
> 
