
R version 2.15.0 (2012-03-30)
Copyright (C) 2012 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> require(pompExamples)
Loading required package: pompExamples
Loading required package: pomp
Loading required package: mvtnorm
Loading required package: subplex
Loading required package: deSolve
> 
> data(pertussis.sim)
> 
> names(pertussis.sim)
[1] "SEIR.small"  "SEIR.big"    "SEIRS.small" "SEIRS.big"   "SEIRR.small"
[6] "SEIRR.big"   "full.small"  "full.big"   
> x <- lapply(pertussis.sim,as.data.frame)
> 
> print(lapply(x,tail))
$SEIR.small
         time reports     S   E   I     R1 R2 cases W err simpop
1036 19.90385      70 26873 244 409 472429  0   225 0   7 499955
1037 19.92308      69 26810 239 435 472458  0   221 0   7 499942
1038 19.94231      54 26797 244 435 472497  0   208 0   7 499973
1039 19.96154      46 26746 274 417 472542  0   205 0   7 499979
1040 19.98077      53 26709 256 450 472538  0   228 0   7 499953
1041 20.00000      71 26679 273 415 472560  0   183 0   7 499927

$SEIR.big
         time reports      S    E    I      R1 R2 cases W err  simpop
1036 19.90385     520 255547 1703 2917 4739686  0  1470 0   7 4999853
1037 19.92308     484 255784 1759 3003 4739211  0  1489 0   7 4999757
1038 19.94231     406 256081 1856 2995 4738900  0  1444 0   7 4999832
1039 19.96154     533 256320 1869 3129 4738606  0  1597 0   7 4999924
1040 19.98077     425 256551 1879 3164 4738317  0  1545 0   7 4999911
1041 20.00000     412 257106 1639 3151 4738010  0  1495 0   7 4999906

$SEIRS.small
         time reports     S   E   I     R1     R2 cases W err simpop
1036 19.90385      47 80392 539 920 228000 190629   467 0   7 500480
1037 19.92308      41 80392 578 909 227952 190651   431 0   7 500482
1038 19.94231      49 80395 591 914 227879 190690   464 0   7 500469
1039 19.96154      67 80471 575 975 227795 190660   500 0   7 500476
1040 19.98077      42 80516 553 993 227732 190669   513 0   7 500463
1041 20.00000      61 80660 492 986 227653 190677   461 0   7 500468

$SEIRS.big
         time reports      S    E    I      R1      R2 cases W err  simpop
1036 19.90385     489 773965 5409 9193 2299336 1912393  4484 0   7 5000296
1037 19.92308     568 774652 5472 9318 2298462 1912401  4574 0   7 5000305
1038 19.94231     397 775170 5539 9426 2297714 1912390  4671 0   7 5000239
1039 19.96154     411 775614 5740 9491 2297059 1912330  4609 0   7 5000234
1040 19.98077     442 776437 5571 9697 2296283 1912273  4748 0   7 5000261
1041 20.00000     518 778090 4858 9441 2295594 1912196  4335 0   7 5000179

$SEIRR.small
         time reports     S   E    I     R1     R2 cases W err simpop
1036 19.90385      73 64537 864 1441 317687 115760   714 0   7 500289
1037 19.92308      69 64260 896 1502 318088 115525   758 0   7 500271
1038 19.94231      76 63954 981 1543 318494 115282   748 0   7 500254
1039 19.96154      84 63664 965 1638 318953 115037   836 0   7 500257
1040 19.98077      91 63373 992 1670 319485 114723   802 0   7 500243
1041 20.00000      81 63266 861 1646 319863 114604   760 0   7 500240

$SEIRR.big
         time reports      S    E    I      R1      R2 cases W err  simpop
1036 19.90385     449 636820 4839 8046 3202063 1148211  3956 0   7 4999979
1037 19.92308     472 637284 4951 8179 3201137 1148414  4114 0   7 4999965
1038 19.94231     438 637653 5019 8240 3200093 1148879  4143 0   7 4999884
1039 19.96154     474 637980 5084 8458 3199122 1149316  4261 0   7 4999960
1040 19.98077     499 638422 4929 8626 3198103 1149922  4307 0   7 5000002
1041 20.00000     469 639527 4413 8258 3196671 1151115  3834 0   7 4999984

$full.small
         time reports     S   E   I     R1     R2 cases         W err simpop
1036 19.90385      38 60812 492 892 330814 107242   437 -9.164189   7 500252
1037 19.92308      35 60904 514 881 330659 107326   413 -9.153313   7 500284
1038 19.94231      44 60988 464 873 330490 107453   420 -9.279501   7 500268
1039 19.96154      46 61032 517 876 330295 107543   398 -9.092366   7 500263
1040 19.98077      39 61122 504 845 330138 107631   403 -9.103926   7 500240
1041 20.00000      43 61258 474 820 329898 107806   384 -8.973250   7 500256

$full.big
         time reports      S    E    I      R1      R2 cases         W err
1036 19.90385     381 685681 5306 8066 3166871 1137704  3943 -5.397648   7
1037 19.92308     526 685987 5712 8423 3165789 1137727  4434 -5.215067   7
1038 19.94231     406 686713 5594 8728 3164496 1138137  4487 -5.376581   7
1039 19.96154     377 687178 5673 8981 3163446 1138391  4463 -5.484270   7
1040 19.98077     549 687709 5515 9310 3162464 1138650  4717 -5.563903   7
1041 20.00000     419 688789 4914 9220 3161008 1139607  4358 -5.568812   7
      simpop
1036 5003628
1037 5003638
1038 5003668
1039 5003669
1040 5003648
1041 5003538

> 
> x <- simulate(pertussis.sim$full.big,seed=395885L,as.data.frame=TRUE)
> tail(x)
         time reports      S    E     I      R1      R2 cases         W err
1036 19.90385     529 634087 5541  9277 3260155 1090900  4646 0.9650237   7
1037 19.92308     345 634343 5687  9453 3259271 1091140  4625 0.9681362   7
1038 19.94231     459 634432 6021  9647 3258692 1091145  4844 1.0560729   7
1039 19.96154     391 634660 6040  9905 3258019 1091364  4918 1.0452093   7
1040 19.98077     565 635319 5595 10107 3257412 1091594  5033 0.8786933   7
1041 20.00000     411 636665 4728  9753 3256002 1092869  4394 0.7840614   7
      simpop sim
1036 4999960   1
1037 4999894   1
1038 4999937   1
1039 4999988   1
1040 5000027   1
1041 5000017   1
> 
> y <- trajectory(pertussis.sim$SEIRS.small,as.data.frame=TRUE)
> tail(y)
            S        E         I       R1       R2 cases W err simpop     time
1036 81409.73 558.4599  942.3100 227353.0 189736.5     0 0   0  5e+05 19.90385
1037 81420.36 573.0107  965.5155 227305.3 189735.8     0 0   0  5e+05 19.92308
1038 81418.14 587.5604  989.6877 227269.6 189735.0     0 0   0  5e+05 19.94231
1039 81402.73 602.3328 1014.5493 227246.2 189734.2     0 0   0  5e+05 19.96154
1040 81415.22 580.7639 1035.4780 227235.2 189733.4     0 0   0  5e+05 19.98077
1041 81532.40 510.2405 1002.6699 227222.2 189732.5     0 0   0  5e+05 20.00000
     traj
1036    1
1037    1
1038    1
1039    1
1040    1
1041    1
> 
> system.time(pf <- pfilter(pertussis.sim$full.small,seed=3445886L,Np=1000))
   user  system elapsed 
 20.957   0.000  21.018 
> logLik(pf)
[1] -3829.33
> 
> proc.time()
   user  system elapsed 
 21.593   0.060  21.732 
