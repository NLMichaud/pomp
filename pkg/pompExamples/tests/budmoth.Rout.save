
R version 2.15.0 (2012-03-30)
Copyright (C) 2012 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> require(pompExamples)
Loading required package: pompExamples
Loading required package: pomp
Loading required package: mvtnorm
Loading required package: subplex
Loading required package: deSolve
> 
> data(budmoth.sim)
> 
> names(budmoth.sim)
[1] "tri"   "para1" "food"  "para2"
> x <- lapply(budmoth.sim,as,"data.frame")
> 
> print(lapply(x,tail))
$tri
   time     Qobs       Nobs         Sobs         Q          N            S
56   55 34.90777  1.3909427 8.760997e-07 0.9860433  1.0105838 1.109173e-06
57   56 33.36428  5.9679756 3.009644e-06 0.9830185 17.7373560 2.949154e-06
58   57 29.34035 68.3377210 7.255485e-05 0.8608373 80.4984855 8.681423e-05
59   58 21.75336  1.2686716 8.552474e-03 0.6310693  0.7176525 9.751675e-03
60   59 29.15848  0.3500365 1.047452e-02 0.8025905  0.3723865 1.256469e-02
61   60 32.98213  1.6128525 6.718390e-03 0.8941107  1.0912736 7.410424e-03
       Alpha   Lambda        A
56 0.5246694 21.95700 1.813852
57 0.4833379 21.87970 1.738908
58 0.5010435 22.22843 1.640583
59 0.5190030 22.45659 1.404177
60 0.5165432 22.20828 1.810056
61 0.5183574 22.01444 1.591250

$para1
   time     Qobs        Nobs        Sobs         Q           N           S
56   55 21.38207  0.68381238 0.907924733 0.6143380  0.55733084 0.997889584
57   56 29.54776  0.02697955 0.430252439 0.8126219  0.02020849 0.573040310
58   57 31.78574  0.07253569 0.020786180 0.9177534  0.17066444 0.022035629
59   58 32.39154  2.81430772 0.005905631 0.9567875  3.49854944 0.005907819
60   59 34.36420 63.29278180 0.031631312 0.9456880 56.35560023 0.033871059
61   60 24.63131 17.42221294 0.790037174 0.7153921 12.65588781 0.871324054
       Alpha   Lambda        A
56 0.5031487 22.14524 1.579994
57 0.4707325 21.78521 1.754212
58 0.4377213 21.75771 1.930505
59 0.5049253 22.14170 1.576733
60 0.4996302 21.90574 1.675765
61 0.5157446 21.68244 1.551352

$food
   time     Qobs        Nobs         Sobs         Q          N            S
56   55 34.13985 16.01354997 3.224917e-06 0.9529645  7.4387892 3.827248e-06
57   56 27.79192 22.28079514 2.070576e-05 0.8502012 19.7570009 2.570550e-05
58   57 24.07011 31.94991132 4.869824e-04 0.6794912 14.4355348 5.305078e-04
59   58 21.81314  1.77819709 7.707581e-03 0.6288764  1.9239332 7.967758e-03
60   59 27.66444  0.24999819 1.516026e-02 0.7899212  0.1973302 1.416005e-02
61   60 28.79342  0.09924733 2.128647e-03 0.8898312  0.1200628 3.272257e-03
       Alpha   Lambda         A
56 0.5153850 4.617116 1.0869780
57 0.5413771 4.932935 0.8677828
58 0.5082460 4.851747 1.0428964
59 0.4871643 4.388592 1.0444642
60 0.4316777 4.394991 0.9302542
61 0.5012195 5.063878 1.1726507

$para2
   time     Qobs      Nobs         Sobs         Q         N            S
56   55 33.68890  3.458362 1.054469e-06 0.9845993  1.799560 1.225629e-06
57   56 33.87640 15.747819 2.248998e-06 0.9749960  6.921067 2.575005e-06
58   57 33.94564 50.157117 1.166632e-05 0.9265344 33.878434 1.350848e-05
59   58 26.54568 39.257279 7.764646e-04 0.7668865 21.145329 1.028206e-03
60   59 25.06245 37.080107 1.942558e-02 0.7334130 32.430161 2.124212e-02
61   60 24.65754 10.630755 8.364070e-01 0.6707489 14.812001 9.357010e-01
       Alpha    Lambda         A
56 0.5199566 23.368648 2.8482104
57 0.5034550  4.475840 0.7140993
58 0.4982577  8.622703 0.7018725
59 0.5168533  9.734355 2.2460464
60 0.4777904  9.364085 0.9906918
61 0.5059549  7.138668 6.7705675

> 
> y <- simulate(budmoth.sim$food,seed=3434996L,as.data.frame=TRUE)
> tail(y)
   time     Qobs      Nobs         Sobs         Q         N            S
56   55 21.60813 9.9416747 0.0084565260 0.6260519 6.6374470 0.0094829150
57   56 23.69758 0.4068012 0.0555572562 0.6960924 0.6909030 0.0655207892
58   57 27.36280 0.1056701 0.0461785098 0.8328430 0.1516087 0.0367590933
59   58 31.64283 0.2311652 0.0054429206 0.9128312 0.1262158 0.0061363639
60   59 33.07830 0.2439202 0.0007323085 0.9501525 0.2684836 0.0007689092
61   60 34.70798 0.4126931 0.0001924636 0.9684718 0.8167865 0.0002084246
       Alpha   Lambda         A sim
56 0.4538116 5.723480 1.0150383   1
57 0.4386467 5.049427 1.0766197   1
58 0.4944825 4.972702 0.8273030   1
59 0.4989262 4.612384 1.1043024   1
60 0.5386598 5.130300 0.9918653   1
61 0.4994891 5.038971 1.0048781   1
> 
> z <- trajectory(budmoth.sim$tri,as.data.frame=TRUE)
> tail(z)
   Q N           S Alpha Lambda   A time traj
56 1 0 9.99998e-07   0.5     22 1.7   55    1
57 1 0 9.99998e-07   0.5     22 1.7   56    1
58 1 0 9.99998e-07   0.5     22 1.7   57    1
59 1 0 9.99998e-07   0.5     22 1.7   58    1
60 1 0 9.99998e-07   0.5     22 1.7   59    1
61 1 0 9.99998e-07   0.5     22 1.7   60    1
> 
> pf <- pfilter(budmoth.sim$food,seed=34348885L,Np=1000)
> logLik(pf)
[1] 355.9053
> 
> proc.time()
   user  system elapsed 
  0.564   0.020   0.602 
